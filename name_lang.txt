LOAD CSV WITH HEADERS FROM 'file:///employees.csv' AS row
// Replace single quotes with double quotes for proper JSON formatting
WITH row, apoc.text.replace(row.Languages, "'", "\"") AS langsStr
// Convert the fixed string into a JSON list
WITH row, apoc.convert.fromJsonList(langsStr) AS languages
// Create or match the Employee node based on the Name property
MERGE (e:Employee {name: row.Name})
// For each language in the languages list, create a Language node and a relationship
FOREACH (lang IN languages |
  MERGE (l:Language {name: lang})
  MERGE (e)-[:LANGUAGES]->(l)
)
RETURN e
